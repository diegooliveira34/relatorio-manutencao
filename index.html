!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Relat√≥rio de Manuten√ß√£o</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f1f5f9; margin: 0; padding: 20px; color: #222; }
    .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h2 { text-align: center; color: #2563eb; margin: 0 0 10px 0; }
    label { font-weight: bold; display: block; margin-top: 12px; }
    input, textarea, select, button { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; margin-top: 5px; font-size: 15px; box-sizing: border-box; }
    .row { display: flex; gap: 8px; }
    .row > * { flex: 1; }
    button { background-color: #2563eb; color: white; cursor: pointer; margin-top: 14px; }
    button.secondary { background: #06b6d4; }
    button:active { transform: translateY(1px); }
    #resultado { white-space: pre-wrap; background: #f9fafb; border-radius: 8px; padding: 12px; margin-top: 14px; font-family: monospace; min-height: 60px; }
    small.hint { color: #555; display: block; margin-top: 6px; }
    footer { text-align:center; margin-top: 14px; color:#666; font-size:13px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>üìã Relat√≥rio de Manuten√ß√£o</h2>

    <label>Data:</label>
    <input type="date" id="data" />

    <label>Turno:</label>
    <select id="turno">
      <option value="1¬∫ Turno">1¬∫ Turno</option>
      <option value="2¬∫ Turno">2¬∫ Turno</option>
      <option value="3¬∫ Turno">3¬∫ Turno</option>
    </select>

    <div class="row">
      <div>
        <label>Equipamento:</label>
        <input type="text" id="equipamento" placeholder="Ex: Cap 30A" />
      </div>
      <div>
        <label>Oficina (opcional):</label>
        <input type="text" id="oficina" placeholder="Ex: Lavando a oficina" />
      </div>
    </div>

    <label>Problema:</label>
    <textarea id="problema" placeholder="Descreva o problema" rows="3"></textarea>

    <label>A√ß√£o:</label>
    <textarea id="acao" placeholder="Descreva a a√ß√£o realizada" rows="3"></textarea>

    <div class="row">
      <button onclick="gerarRelatorio()">Gerar Relat√≥rio</button>
      <button class="secondary" onclick="limparCampos()">Limpar</button>
    </div>
    <div class="row">
      <button onclick="enviarWhatsApp()">Enviar via WhatsApp</button>
    </div>

    <div id="resultado"></div>
    <small class="hint">Dica: abra este arquivo no Chrome no celular para usar como aplicativo (Adicionar √† tela inicial).</small>

    <footer>Relat√≥rio T√©cnico ‚Ä¢ Gerado localmente</footer>
  </div>

  <script>
    // Preenche data com data atual
    (function setDefaultDate() {
      const d = new Date();
      const yyyy = d.getFullYear();
      const mm = String(d.getMonth()+1).padStart(2,'0');
      const dd = String(d.getDate()).padStart(2,'0');
      const iso = yyyy + '-' + mm + '-' + dd;
      document.getElementById('data').value = iso;
    })();

    // Fun√ß√£o para tocar um beep curto usando Web Audio API
    function playBeep(duration = 0.08, frequency = 880, volume = 0.08) {
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.type = 'sine';
        o.frequency.value = frequency;
        g.gain.value = volume;
        o.connect(g);
        g.connect(ctx.destination);
        o.start();
        setTimeout(function(){
          o.stop();
          ctx.close();
        }, duration * 1000);
      } catch (e) {
        // Fallback: n√£o fazer nada se n√£o suportado
        console.log('Audio not supported', e);
      }
    }

    function gerarRelatorio() {
      const data = document.getElementById('data').value;
      const turno = document.getElementById('turno').value;
      const equipamento = document.getElementById('equipamento').value.trim();
      const problema = document.getElementById('problema').value.trim();
      const acao = document.getElementById('acao').value.trim();
      const oficina = document.getElementById('oficina').value.trim();

      if (!data) {
        alert('Por favor selecione a data.');
        return;
      }
      if (!equipamento && !problema && !acao && !oficina) {
        alert('Preencha ao menos um campo para gerar o relat√≥rio.');
        return;
      }

      // Monta a mensagem no padr√£o
      let msg = 'üìã Relat√≥rio de Manuten√ß√£o\n';
      msg += 'üìÖ Data: ' + formatDateBR(data) + '\n';
      msg += 'üïì Turno: ' + turno + '\n\n';

      if (equipamento) {
        msg += '‚öôÔ∏è Equipamento: ' + equipamento + '\n';
      }
      if (problema) {
        msg += '‚ùó Problema: ' + problema + '\n';
      }
      if (acao) {
        msg += 'üîß A√ß√£o: ' + acao + '\n';
      }
      if (oficina) {
        msg += '\nüßΩ Oficina: ' + oficina + '\n';
      }

      document.getElementById('resultado').textContent = msg;
      playBeep(); // som ao gerar
    }

    function formatDateBR(isoDate) {
      // isoDate no formato yyyy-mm-dd
      const parts = isoDate.split('-');
      if (parts.length === 3) {
        return parts[2] + '/' + parts[1] + '/' + parts[0];
      }
      return isoDate;
    }

    function enviarWhatsApp() {
      const texto = document.getElementById('resultado').textContent;
      if (!texto) {
        alert('Gere o relat√≥rio antes de enviar.');
        return;
      }
      playBeep(0.06, 660, 0.06); // som de confirma√ß√£o
      // Abre o WhatsApp Web/Aplicativo com a mensagem pronta
      const url = 'https://wa.me/?text=' + encodeURIComponent(texto);
      // tenta abrir em nova aba
      window.open(url, '_blank');
    }

    function limparCampos() {
      if (!confirm('Deseja limpar todos os campos?')) return;
      document.getElementById('equipamento').value = '';
      document.getElementById('problema').value = '';
      document.getElementById('acao').value = '';
      document.getElementById('oficina').value = '';
      document.getElementById('resultado').textContent = '';
      playBeep(0.04, 440, 0.04);
    }
  </script>
</body>
</html>

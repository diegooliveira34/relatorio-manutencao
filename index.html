<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RelatÃ³rio de ManutenÃ§Ã£o v3</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background-color: #f8f9fa; }
  h2 { text-align: center; color: #333; }
  label { font-weight: bold; margin-top: 10px; display: block; }
  input, select, textarea { width: 100%; padding: 6px; margin-top: 4px; border-radius: 5px; border: 1px solid #ccc; }
  button { margin-top: 10px; padding: 10px; border: none; border-radius: 8px; cursor: pointer; }
  .add-btn { background-color: #28a745; color: white; }
  .remove-btn { background-color: #dc3545; color: white; margin-top: 5px; }
  .generate-btn { background-color: #007bff; color: white; }
  .equipamento { background: #fff; padding: 10px; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
  .preventivo-area { display: none; background: #fff3cd; padding: 10px; border-radius: 10px; margin-top: 10px; }
</style>
</head>
<body>

<h2>ðŸ“‹ RelatÃ³rio de ManutenÃ§Ã£o</h2>

<label>Data:</label>
<input type="date" id="data">

<label>Turno:</label>
<select id="turno">
  <option value="1Âº Turno">1Âº Turno</option>
  <option value="2Âº Turno">2Âº Turno</option>
  <option value="3Âº Turno">3Âº Turno</option>
</select>

<label>TÃ©cnico ResponsÃ¡vel:</label>
<input type="text" id="tecnico" placeholder="Digite o nome do tÃ©cnico">

<div id="equipamentos"></div>
<button class="add-btn" onclick="adicionarEquipamento()">âž• Adicionar Equipamento</button>

<label>Necessita Plano Preventivo?</label>
<select id="preventivo" onchange="togglePreventivo()">
  <option value="NÃ£o">NÃ£o</option>
  <option value="Sim">Sim</option>
</select>

<div class="preventivo-area" id="preventivoArea">
  <label>Selecione os Equipamentos:</label>
  <div id="listaPreventivo"></div>
  <label>ObservaÃ§Ãµes:</label>
  <textarea id="obsPreventivo" placeholder="Descreva detalhes do plano preventivo..."></textarea>
</div>

<button class="generate-btn" onclick="gerarRelatorio()">ðŸ“„ Gerar RelatÃ³rio</button>
<button class="generate-btn" onclick="enviarWhatsApp()">ðŸ’¬ Enviar via WhatsApp</button>

<textarea id="resultado" rows="12" readonly placeholder="O relatÃ³rio gerado aparecerÃ¡ aqui..."></textarea>

<script>
let contador = 0;

function adicionarEquipamento() {
  contador++;
  const div = document.createElement('div');
  div.classList.add('equipamento');
  div.innerHTML = `
    <label>Equipamento:</label>
    <input type="text" id="equipamento${contador}" placeholder="Nome do equipamento">
    <label>Problema:</label>
    <textarea id="problema${contador}" placeholder="Descreva o problema..."></textarea>
    <label>AÃ§Ã£o:</label>
    <textarea id="acao${contador}" placeholder="Descreva a aÃ§Ã£o realizada..."></textarea>
    <button class="remove-btn" onclick="this.parentElement.remove()">Remover</button>
  `;
  document.getElementById('equipamentos').appendChild(div);
  atualizarListaPreventivo();
}

function atualizarListaPreventivo() {
  const listaDiv = document.getElementById('listaPreventivo');
  listaDiv.innerHTML = '';
  for (let i = 1; i <= contador; i++) {
    const equip = document.getElementById(`equipamento${i}`);
    if (equip) {
      listaDiv.innerHTML += `<label><input type="checkbox" value="${equip.value || 'Equipamento ' + i}"> ${equip.value || 'Equipamento ' + i}</label><br>`;
    }
  }
}

function togglePreventivo() {
  const area = document.getElementById('preventivoArea');
  area.style.display = document.getElementById('preventivo').value === 'Sim' ? 'block' : 'none';
}

function gerarRelatorio() {
  let som = new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg'); som.play();
  const data = document.getElementById('data').value;
  const turno = document.getElementById('turno').value;
  const tecnico = document.getElementById('tecnico').value;
  let relatorio = `ðŸ“‹ RelatÃ³rio de ManutenÃ§Ã£o\nðŸ“… Data: ${data}\nðŸ•“ Turno: ${turno}\nðŸ‘· TÃ©cnico ResponsÃ¡vel: ${tecnico}\n\n`;
  
  for (let i = 1; i <= contador; i++) {
    const equip = document.getElementById(`equipamento${i}`);
    const prob = document.getElementById(`problema${i}`);
    const acao = document.getElementById(`acao${i}`);
    if (equip) {
      relatorio += `âš™ï¸ Equipamento: ${equip.value}\n`;
      if (prob.value) relatorio += `â— Problema: ${prob.value}\n`;
      if (acao.value) relatorio += `ðŸ”§ AÃ§Ã£o: ${acao.value}\n\n`;
    }
  }

  const preventivo = document.getElementById('preventivo').value;
  relatorio += `ðŸ› ï¸ Necessita Plano Preventivo? ${preventivo}\n`;

  if (preventivo === 'Sim') {
    const selecionados = [...document.querySelectorAll('#listaPreventivo input:checked')].map(el => el.value);
    const obs = document.getElementById('obsPreventivo').value;
    relatorio += `Equipamentos para Preventivo: ${selecionados.join(', ')}\n`;
    if (obs) relatorio += `ObservaÃ§Ãµes: ${obs}\n`;
  }

  document.getElementById('resultado').value = relatorio.trim();
}

function enviarWhatsApp() {
  let som = new Audio('https://actions.google.com/sounds/v1/cartoon/slide_whistle_to_drum_hit.ogg'); som.play();
  const texto = encodeURIComponent(document.getElementById('resultado').value);
  window.open(`https://wa.me/?text=${texto}`, '_blank');
}
</script>
</body>
</html>
